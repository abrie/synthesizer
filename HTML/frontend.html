<!doctype html>
<html ng-app="frontend">
<head>
	<script src="lib/angular.js"></script>
	<script src="lib/underscore.js"></script>
	<script src="utilities.js"></script>
	<script src="websocket.js"></script>
	<script src="frontend.js"></script>
	<link rel="stylesheet" href="frontend.css">
</head>
<body>
	<div ng-controller="SocketControl" id="menu">
		<div id="tick-indicator" on=false></div>
		<div id="connection-status" ng-class="connectionStatus"></div>
		<button id="sync">sync</button>
		<button id="get-last-sync">get-last-sync</button>
		<button id="render">render</button>
	</div>
	<div ng-controller="NodeCtrl" id="application">
		<ul class="unstyled">
			<li ng-repeat="node in nodes">
				<span>{{node.type}}:{{node.name}}</span>
				<ng-switch on="node.type">
					<div ng-switch-when="root">
						<button ng-click="addNewNodeTo(node)" >+branch</button>
						<button ng-click="addNewEmitterTo(node)" >+emitter</button>
						<input ng-model="node.parameters.rhythm.steps">
						<input ng-model="node.parameters.rhythm.steps" type="range" max="100" min="1" >
						<input ng-model="node.parameters.rhythm.pulses">
						<input ng-model="node.parameters.rhythm.pulses" type="range" max="100" min="1" >
						<input ng-model="node.parameters.rhythm.ticksPerStep">
						<input ng-model="node.parameters.rhythm.ticksPerPulse">
						<input ng-model="node.parameters.rhythm.totalTicks">
						<input ng-model="node.parameters.rhythm.retrigger" type="checkbox" >
						<ul class="unstyled">
							<li ng-repeat="nodeName in node.pool">{{nodeName}}</li>
						</ul>                     
					</div>
					<div ng-switch-when="branch">
						<button ng-click="addNewNodeTo(node)" >+branch</button>
						<button ng-click="addNewEmitterTo(node)" >+emitter</button>
						<input ng-model="node.parameters.rhythm.steps">
						<input ng-model="node.parameters.rhythm.steps" type="range" max="100" min="1" >
						<input ng-model="node.parameters.rhythm.pulses">
						<input ng-model="node.parameters.rhythm.pulses" type="range" max="100" min="1" >
						<input ng-model="node.parameters.rhythm.ticksPerStep">
						<input ng-model="node.parameters.rhythm.ticksPerPulse">
						<input ng-model="node.parameters.rhythm.totalTicks">
						<input ng-model="node.parameters.rhythm.retrigger" type="checkbox" >
						<ul class="unstyled">
							<li ng-repeat="nodeName in node.pool">{{nodeName}}</li>
						</ul>                     
					</div>
					<div ng-switch-when="emitter">
						<div>
							<input ng-model="node.parameters.rhythm.steps">
							<input ng-model="node.parameters.rhythm.steps" type="range" max="100" min="1" >
							<input ng-model="node.parameters.rhythm.pulses">
							<input ng-model="node.parameters.rhythm.pulses" type="range" max="100" min="1" >
							<input ng-model="node.parameters.rhythm.ticksPerStep">
							<input ng-model="node.parameters.rhythm.ticksPerPulse">
							<input ng-model="node.parameters.rhythm.totalTicks">
							<input ng-model="node.parameters.rhythm.retrigger" type="checkbox" >
						</div>
						<select ng-model="node.parameters.indexer" ng-options="indexer for indexer in indexerTypes"></select>
						<div>
							<piano ng-model="node.parameters.note.pool">
						</div>
						<div class="table">
							<div class="row">
								<div class="cell">field</div>
								<div class="cell">seed</div>
								<div class="cell">mask</div>
								<div class="cell">pool</div>
							</div>
							<div class="row">
								<div class="cell">note</div>
								<div class="cell"><input ng-model="node.parameters.note.seed"></div>
								<div class="cell"><input ng-model="node.parameters.note.mask"></div>
								<div class="cell"><input array ng-model="node.parameters.note.pool"></div>
							</div>
							<div class="row">
								<div class="cell">channel</div>
								<div class="cell"><input ng-model="node.parameters.channel.seed"></div>
								<div class="cell"><input ng-model="node.parameters.channel.mask"></div>
								<div class="cell"><input array ng-model="node.parameters.channel.pool"></div>
							</div>
							<div class="row">
								<div class="cell">onVelocity</div>
								<div class="cell"><input ng-model="node.parameters.onVelocity.seed"></div>
								<div class="cell"><input ng-model="node.parameters.onVelocity.mask"></div>
								<div class="cell"><input array ng-model="node.parameters.onVelocity.pool"></div>
							</div>
							<div class="row">
								<div class="cell">offVelocity</div>
								<div class="cell"><input ng-model="node.parameters.offVelocity.seed"></div>
								<div class="cell"><input ng-model="node.parameters.offVelocity.mask"></div>
								<div class="cell"><input array ng-model="node.parameters.offVelocity.pool"></div>
							</div>
							<div class="row">
								<div class="cell">duration</div>
								<div class="cell"><input ng-model="node.parameters.duration.seed"></div>
								<div class="cell"><input ng-model="node.parameters.duration.mask"></div>
								<div class="cell"><input array ng-model="node.parameters.duration.pool"></div>
							</div>
						</div>
					</div>
					<div ng-switch-default>
						unknown type
					</div>
				</ng-switch>
			</li>
		</ul>
		<form ng-submit="addRoot()">
			<input type="text" ng-model="nodeName"  size="30" placeholder="add new root here">
			<input class="btn-primary" type="submit" value="+root">
		</form>
		<form ng-submit="addNode()">
			<input type="text" ng-model="nodeName"  size="30" placeholder="add new node here">
			<input class="btn-primary" type="submit" value="+branch">
		</form>
		<form ng-submit="addEmitter()">
			<input type="text" ng-model="emitterName"  size="30" placeholder="add new emitter here">
			<input class="btn-primary" type="submit" value="+emitter">
		</form>
	</div>
	<div id="nonsense">project feelers w/ angularjs 1988(c)(tm)(r)(xXx) !URUNDERANNDA!</div>
</body>
</html>
